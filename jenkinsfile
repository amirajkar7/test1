pipeline {
	agent {
		label {
			label "built-in"
			
		}
	}
	
	stages {
		stage ("cleaning repo files and webapp file"){
			steps {
				sh "rm -rf /root/.m2/ *"
				sh "rm -rf /mnt/project"
				sh "rm -rf /mnt/servers/apache-tomcat-10.1.49/webapps/LoginWebApp*"
			}
		}
		stage ("cloning git repo"){
			agent {
			node {
				label "built-in"
				customWorkspace "/mnt/"
			}
			}
			steps {
				git url: "https://github.com/amirajkar7/project.git"
			}
		}
		stage ("building project code"){
		    agent {
			node {
				label "built-in"
				customWorkspace "/mnt/project"
			}
			}
			steps {
				sh "mvn clean package"
			}
		}
		stage ("copying war file"){
			steps {
				sh "cp -r /mnt/project/target/LoginWebApp.war /mnt/servers/apache-tomcat-10.1.49/webapps"
			}
		}
	}

}
